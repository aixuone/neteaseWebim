!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WhiteBoard=t():e.WhiteBoard=t()}(window,function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=367)}([,function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var i=n(36)("wks"),o=n(26),r=n(1).Symbol,a="function"==typeof r;(e.exports=function(e){return i[e]||(i[e]=a&&r[e]||(a?r:o)("Symbol."+e))}).store=i},function(e,t,n){"use strict";var i={info:{hash:"b673e1061edc2c68f882c04c1a45a56950fb1231",shortHash:"b673e106",version:"5.2.0",sdkVersion:"49",nrtcVersion:"4.0.0",nrtcSdkVersion:"1",protocolVersion:1},agentVersion:"2.6.0.328",lbsUrl:"https://lbs.netease.im/lbs/webconf.jsp",roomserver:"roomserver.netease.im",connectTimeout:18e3,xhrTimeout:18e3,socketTimeout:18e3,reconnectionDelay:1e3,reconnectionDelayMax:18e3,reconnectionJitter:.1,heartbeatInterval:18e4,cmdTimeout:18e3,defaultReportUrl:"https://dr.netease.im/1.gif",isWeixinApp:!1,isNodejs:!1,isRN:!1,formatSocketUrl:function(e){var t=e.url,n=e.secure?"https":"http";return-1===t.indexOf("http")?n+"://"+t:t},uploadUrl:"https://nos.netease.com",replaceUrl:"https://{bucket}.nosdn.127.net/{object}",downloadHost:"nos.netease.com",downloadUrl:"https://{bucket}.nosdn.127.net/{object}",httpsEnabled:!1,genUploadUrl:function(e){return i.uploadUrl+"/"+e},genDownloadUrl:function(e,t){var n=i.replaceUrl;return/^http/.test(n)?i.httpsEnabled&&(n=n.replace("http","https")):n=i.httpsEnabled?"https://"+n:"http://"+n,n.replace("{bucket}",e).replace("{object}",t)}};e.exports=i},function(e,t){var n=e.exports={version:"2.5.6"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";t.__esModule=!0;var i=a(n(94)),o=a(n(83)),r="function"==typeof o.default&&"symbol"==typeof i.default?function(e){return typeof e}:function(e){return e&&"function"==typeof o.default&&e.constructor===o.default&&e!==o.default.prototype?"symbol":typeof e};function a(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof o.default&&"symbol"===r(i.default)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof o.default&&e.constructor===o.default&&e!==o.default.prototype?"symbol":void 0===e?"undefined":r(e)}},function(e,t,n){var i=n(9),o=n(54),r=n(38),a=Object.defineProperty;t.f=n(8)?Object.defineProperty:function(e,t,n){if(i(e),t=r(t,!0),i(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){e.exports=!n(16)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var i=n(11);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var i=n(6),o=n(19);e.exports=n(8)?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var i=n(68),o=n(39);e.exports=function(e){return i(o(e))}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){var i=n(1),o=n(4),r=n(42),a=n(10),s=n(7),c=function(e,t,n){var u,l,f,d=e&c.F,p=e&c.G,h=e&c.S,b=e&c.P,g=e&c.B,v=e&c.W,y=p?o:o[t]||(o[t]={}),m=y.prototype,_=p?i:h?i[t]:(i[t]||{}).prototype;for(u in p&&(n=t),n)(l=!d&&_&&void 0!==_[u])&&s(y,u)||(f=l?_[u]:n[u],y[u]=p&&"function"!=typeof _[u]?n[u]:g&&l?r(f,i):v&&_[u]==f?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(f):b&&"function"==typeof f?r(Function.call,f):f,b&&((y.virtual||(y.virtual={}))[u]=f,e&c.R&&m&&!m[u]&&a(m,u,f)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){"use strict";(function(t){var i,o=n(5),r=(i=o)&&i.__esModule?i:{default:i};var a=function(){var e="object"===(void 0===t?"undefined":(0,r.default)(t))?t:window,n=Math.pow(2,53)-1,i=/\bOpera/,o=Object.prototype,a=o.hasOwnProperty,s=o.toString;function c(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function u(e){return e=h(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:c(e)}function l(e,t){for(var n in e)a.call(e,n)&&t(e[n],n,e)}function f(e){return null==e?c(e):s.call(e).slice(8,-1)}function d(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function p(e,t){var i=null;return function(e,t){var i=-1,o=e?e.length:0;if("number"==typeof o&&o>-1&&o<=n)for(;++i<o;)t(e[i],i,e);else l(e,t)}(e,function(n,o){i=t(i,n,o,e)}),i}function h(e){return String(e).replace(/^ +| +$/g,"")}return function t(n){var o=e,a=n&&"object"==(void 0===n?"undefined":(0,r.default)(n))&&"String"!=f(n);a&&(o=n,n=null);var c=o.navigator||{},b=c.userAgent||"";n||(n=b);var g,v,y,m,_,C=a?!!c.likeChrome:/\bChrome\b/.test(n)&&!/internal|\n/i.test(s.toString()),S=a?"Object":"ScriptBridgingProxyObject",O=a?"Object":"Environment",T=a&&o.java?"JavaPackage":f(o.java),w=a?"Object":"RuntimeObject",E=/\bJava/.test(T)&&o.java,I=E&&f(o.environment)==O,A=E?"a":"α",M=E?"b":"β",N=o.document||{},x=o.operamini||o.opera,P=i.test(P=a&&x?x["[[Class]]"]:f(x))?P:x=null,k=n,D=[],L=null,R=n==b,j=R&&x&&"function"==typeof x.version&&x.version(),W=p([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(e,t){return e||RegExp("\\b"+(t.pattern||d(t))+"\\b","i").exec(n)&&(t.label||t)}),B=function(e){return p(e,function(e,t){return e||RegExp("\\b"+(t.pattern||d(t))+"\\b","i").exec(n)&&(t.label||t)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),U=Y([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),H=function(e){return p(e,function(e,t,i){return e||(t[U]||t[/^[a-z]+(?: +[a-z]+\b)*/i.exec(U)]||RegExp("\\b"+d(i)+"(?:\\b|\\w*\\d)","i").exec(n))&&i})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),F=function(e){return p(e,function(e,t){var i=t.pattern||d(t);return!e&&(e=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(n))&&(e=function(e,t,n){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\d.]+$/.exec(e)])&&(e="Windows "+i),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),e=u(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,i,t.label||t)),e})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Y(e){return p(e,function(e,t){var i=t.pattern||d(t);return!e&&(e=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(n)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(n)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(n))&&((e=String(t.label&&!RegExp(i,"i").test(t.label)?t.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),t=t.label||t,e=u(e[0].replace(RegExp(i,"i"),t).replace(RegExp("; *(?:"+t+"[_-])?","i")," ").replace(RegExp("("+t+")[-_.]?(\\w)","i"),"$1 $2"))),e})}if(W&&(W=[W]),H&&!U&&(U=Y([H])),(g=/\bGoogle TV\b/.exec(U))&&(U=g[0]),/\bSimulator\b/i.test(n)&&(U=(U?U+" ":"")+"Simulator"),"Opera Mini"==B&&/\bOPiOS\b/.test(n)&&D.push("running in Turbo/Uncompressed mode"),"IE"==B&&/\blike iPhone OS\b/.test(n)?(H=(g=t(n.replace(/like iPhone OS/,""))).manufacturer,U=g.product):/^iP/.test(U)?(B||(B="Safari"),F="iOS"+((g=/ OS ([\d_]+)/i.exec(n))?" "+g[1].replace(/_/g,"."):"")):"Konqueror"!=B||/buntu/i.test(F)?H&&"Google"!=H&&(/Chrome/.test(B)&&!/\bMobile Safari\b/i.test(n)||/\bVita\b/.test(U))||/\bAndroid\b/.test(F)&&/^Chrome/.test(B)&&/\bVersion\//i.test(n)?(B="Android Browser",F=/\bAndroid\b/.test(F)?F:"Android"):"Silk"==B?(/\bMobi/i.test(n)||(F="Android",D.unshift("desktop mode")),/Accelerated *= *true/i.test(n)&&D.unshift("accelerated")):"PaleMoon"==B&&(g=/\bFirefox\/([\d.]+)\b/.exec(n))?D.push("identifying as Firefox "+g[1]):"Firefox"==B&&(g=/\b(Mobile|Tablet|TV)\b/i.exec(n))?(F||(F="Firefox OS"),U||(U=g[1])):!B||(g=!/\bMinefield\b/i.test(n)&&/\b(?:Firefox|Safari)\b/.exec(B))?(B&&!U&&/[\/,]|^[^(]+?\)/.test(n.slice(n.indexOf(g+"/")+8))&&(B=null),(g=U||H||F)&&(U||H||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(F))&&(B=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(F)?F:g)+" Browser")):"Electron"==B&&(g=(/\bChrome\/([\d.]+)\b/.exec(n)||0)[1])&&D.push("Chromium "+g):F="Kubuntu",j||(j=p(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",d(B),"(?:Firefox|Minefield|NetFront)"],function(e,t){return e||(RegExp(t+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(n)||0)[1]||null})),(g=("iCab"==W&&parseFloat(j)>3?"WebKit":/\bOpera\b/.test(B)&&(/\bOPR\b/.test(n)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(n)&&!/^(?:Trident|EdgeHTML)$/.test(W)&&"WebKit"||!W&&/\bMSIE\b/i.test(n)&&("Mac OS"==F?"Tasman":"Trident")||"WebKit"==W&&/\bPlayStation\b(?! Vita\b)/i.test(B)&&"NetFront")&&(W=[g]),"IE"==B&&(g=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(n)||0)[1])?(B+=" Mobile",F="Windows Phone "+(/\+$/.test(g)?g:g+".x"),D.unshift("desktop mode")):/\bWPDesktop\b/i.test(n)?(B="IE Mobile",F="Windows Phone 8.x",D.unshift("desktop mode"),j||(j=(/\brv:([\d.]+)/.exec(n)||0)[1])):"IE"!=B&&"Trident"==W&&(g=/\brv:([\d.]+)/.exec(n))&&(B&&D.push("identifying as "+B+(j?" "+j:"")),B="IE",j=g[1]),R){if(m="global",_=null!=(y=o)?(0,r.default)(y[m]):"number",/^(?:boolean|number|string|undefined)$/.test(_)||"object"==_&&!y[m])f(g=o.runtime)==S?(B="Adobe AIR",F=g.flash.system.Capabilities.os):f(g=o.phantom)==w?(B="PhantomJS",j=(g=g.version||null)&&g.major+"."+g.minor+"."+g.patch):"number"==typeof N.documentMode&&(g=/\bTrident\/(\d+)/i.exec(n))?(j=[j,N.documentMode],(g=+g[1]+4)!=j[1]&&(D.push("IE "+j[1]+" mode"),W&&(W[1]=""),j[1]=g),j="IE"==B?String(j[1].toFixed(1)):j[0]):"number"==typeof N.documentMode&&/^(?:Chrome|Firefox)\b/.test(B)&&(D.push("masking as "+B+" "+j),B="IE",j="11.0",W=["Trident"],F="Windows");else if(E&&(k=(g=E.lang.System).getProperty("os.arch"),F=F||g.getProperty("os.name")+" "+g.getProperty("os.version")),I){try{j=o.require("ringo/engine").version.join("."),B="RingoJS"}catch(e){(g=o.system)&&g.global.system==o.system&&(B="Narwhal",F||(F=g[0].os||null))}B||(B="Rhino")}else"object"==(0,r.default)(o.process)&&!o.process.browser&&(g=o.process)&&("object"==(0,r.default)(g.versions)&&("string"==typeof g.versions.electron?(D.push("Node "+g.versions.node),B="Electron",j=g.versions.electron):"string"==typeof g.versions.nw&&(D.push("Chromium "+j,"Node "+g.versions.node),B="NW.js",j=g.versions.nw)),B||(B="Node.js",k=g.arch,F=g.platform,j=(j=/[\d.]+/.exec(g.version))?j[0]:null));F=F&&u(F)}if(j&&(g=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(j)||/(?:alpha|beta)(?: ?\d)?/i.exec(n+";"+(R&&c.appMinorVersion))||/\bMinefield\b/i.test(n)&&"a")&&(L=/b/i.test(g)?"beta":"alpha",j=j.replace(RegExp(g+"\\+?$"),"")+("beta"==L?M:A)+(/\d+\+?/.exec(g)||"")),"Fennec"==B||"Firefox"==B&&/\b(?:Android|Firefox OS)\b/.test(F))B="Firefox Mobile";else if("Maxthon"==B&&j)j=j.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(U))"Xbox 360"==U&&(F=null),"Xbox 360"==U&&/\bIEMobile\b/.test(n)&&D.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(B)&&(!B||U||/Browser|Mobi/.test(B))||"Windows CE"!=F&&!/Mobi/i.test(n))if("IE"==B&&R)try{null===o.external&&D.unshift("platform preview")}catch(e){D.unshift("embedded")}else(/\bBlackBerry\b/.test(U)||/\bBB10\b/.test(n))&&(g=(RegExp(U.replace(/ +/g," *")+"/([.\\d]+)","i").exec(n)||0)[1]||j)?(F=((g=[g,/BB10/.test(n)])[1]?(U=null,H="BlackBerry"):"Device Software")+" "+g[0],j=null):this!=l&&"Wii"!=U&&(R&&x||/Opera/.test(B)&&/\b(?:MSIE|Firefox)\b/i.test(n)||"Firefox"==B&&/\bOS X (?:\d+\.){2,}/.test(F)||"IE"==B&&(F&&!/^Win/.test(F)&&j>5.5||/\bWindows XP\b/.test(F)&&j>8||8==j&&!/\bTrident\b/.test(n)))&&!i.test(g=t.call(l,n.replace(i,"")+";"))&&g.name&&(g="ing as "+g.name+((g=g.version)?" "+g:""),i.test(B)?(/\bIE\b/.test(g)&&"Mac OS"==F&&(F=null),g="identify"+g):(g="mask"+g,B=P?u(P.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(g)&&(F=null),R||(j=null)),W=["Presto"],D.push(g));else B+=" Mobile";(g=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(n)||0)[1])&&(g=[parseFloat(g.replace(/\.(\d)$/,".0$1")),g],"Safari"==B&&"+"==g[1].slice(-1)?(B="WebKit Nightly",L="alpha",j=g[1].slice(0,-1)):j!=g[1]&&j!=(g[2]=(/\bSafari\/([\d.]+\+?)/i.exec(n)||0)[1])||(j=null),g[1]=(/\bChrome\/([\d.]+)/i.exec(n)||0)[1],537.36==g[0]&&537.36==g[2]&&parseFloat(g[1])>=28&&"WebKit"==W&&(W=["Blink"]),R&&(C||g[1])?(W&&(W[1]="like Chrome"),g=g[1]||((g=g[0])<530?1:g<532?2:g<532.05?3:g<533?4:g<534.03?5:g<534.07?6:g<534.1?7:g<534.13?8:g<534.16?9:g<534.24?10:g<534.3?11:g<535.01?12:g<535.02?"13+":g<535.07?15:g<535.11?16:g<535.19?17:g<536.05?18:g<536.1?19:g<537.01?20:g<537.11?"21+":g<537.13?23:g<537.18?24:g<537.24?25:g<537.36?26:"Blink"!=W?"27":"28")):(W&&(W[1]="like Safari"),g=(g=g[0])<400?1:g<500?2:g<526?3:g<533?4:g<534?"4+":g<535?5:g<537?6:g<538?7:g<601?8:"8"),W&&(W[1]+=" "+(g+="number"==typeof g?".x":/[.+]/.test(g)?"":"+")),"Safari"==B&&(!j||parseInt(j)>45)&&(j=g)),"Opera"==B&&(g=/\bzbov|zvav$/.exec(F))?(B+=" ",D.unshift("desktop mode"),"zvav"==g?(B+="Mini",j=null):B+="Mobile",F=F.replace(RegExp(" *"+g+"$"),"")):"Safari"==B&&/\bChrome\b/.exec(W&&W[1])&&(D.unshift("desktop mode"),B="Chrome Mobile",j=null,/\bOS X\b/.test(F)?(H="Apple",F="iOS 4.3+"):F=null),j&&0==j.indexOf(g=/[\d.]+$/.exec(F))&&n.indexOf("/"+g+"-")>-1&&(F=h(F.replace(g,""))),W&&!/\b(?:Avant|Nook)\b/.test(B)&&(/Browser|Lunascape|Maxthon/.test(B)||"Safari"!=B&&/^iOS/.test(F)&&/\bSafari\b/.test(W[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(B)&&W[1])&&(g=W[W.length-1])&&D.push(g),D.length&&(D=["("+D.join("; ")+")"]),H&&U&&U.indexOf(H)<0&&D.push("on "+H),U&&D.push((/^on /.test(D[D.length-1])?"":"on ")+U),F&&(g=/ ([\d.+]+)$/.exec(F),v=g&&"/"==F.charAt(F.length-g[0].length-1),F={architecture:32,family:g&&!v?F.replace(g[0],""):F,version:g?g[1]:null,toString:function(){var e=this.version;return this.family+(e&&!v?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(g=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(k))&&!/\bi686\b/i.test(k)?(F&&(F.architecture=64,F.family=F.family.replace(RegExp(" *"+g),"")),B&&(/\bWOW64\b/i.test(n)||R&&/\w(?:86|32)$/.test(c.cpuClass||c.platform)&&!/\bWin64; x64\b/i.test(n))&&D.unshift("32-bit")):F&&/^OS X/.test(F.family)&&"Chrome"==B&&parseFloat(j)>=39&&(F.architecture=64),n||(n=null);var V={};return V.description=n,V.layout=W&&W[0],V.manufacturer=H,V.name=B,V.prerelease=L,V.product=U,V.ua=n,V.version=B&&j,V.os=F||{architecture:null,family:null,version:null,toString:function(){return"null"}},V.parse=t,V.toString=function(){return this.description||""},V.version&&D.unshift(j),V.name&&D.unshift(B),F&&B&&(F!=String(F).split(" ")[0]||F!=B.split(" ")[0]&&!U)&&D.push(U?"("+F+")":"on "+F),D.length&&(V.description=D.join(" ")),V}()}();e.exports=a}).call(this,n(27))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},,function(e,t){e.exports={}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=!0},function(e,t,n){"use strict";t.__esModule=!0;var i=a(n(136)),o=a(n(132)),r=a(n(5));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,r.default)(t)));e.prototype=(0,o.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i.default?(0,i.default)(e,t):e.__proto__=t)}},function(e,t,n){"use strict";t.__esModule=!0;var i,o=n(5),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,r.default)(t))&&"function"!=typeof t?e:t}},,function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.url2origin=t.uniqueID=t.off=t.removeEventListener=t.on=t.addEventListener=t.format=t.regWhiteSpace=t.regBlank=t.emptyFunc=t.f=t.emptyObj=t.o=void 0;var i,o=n(5),r=(i=o)&&i.__esModule?i:{default:i};t.getGlobal=a,t.detectCSSFeature=function(e){var t=!1,n="Webkit Moz ms O".split(" "),i=document.createElement("div"),o=null;e=e.toLowerCase(),void 0!==i.style[e]&&(t=!0);if(!1===t){o=e.charAt(0).toUpperCase()+e.substr(1);for(var r=0;r<n.length;r++)if(void 0!==i.style[n[r]+o]){t=!0;break}}return t},t.fix=s,t.getYearStr=c,t.getMonthStr=u,t.getDayStr=l,t.getHourStr=f,t.getMinuteStr=d,t.getSecondStr=p,t.getMillisecondStr=h,t.dateFromDateTimeLocal=function(e){return e=""+e,new Date(e.replace(/-/g,"/").replace("T"," "))},t.getClass=v,t.typeOf=y,t.isString=m,t.isNumber=function(e){return"number"===y(e)},t.isBoolean=function(e){return"boolean"===y(e)},t.isArray=_,t.isFunction=C,t.isDate=S,t.isRegExp=function(e){return"regexp"===y(e)},t.isError=function(e){return"error"===y(e)},t.isnull=O,t.notnull=T,t.undef=w,t.notundef=E,t.exist=I,t.notexist=A,t.isObject=M,t.isEmpty=function(e){return A(e)||(m(e)||_(e))&&0===e.length},t.containsNode=function(e,t){if(e===t)return!0;for(;t.parentNode;){if(t.parentNode===e)return!0;t=t.parentNode}return!1},t.calcHeight=function(e){var t=e.parentNode||document.body;(e=e.cloneNode(!0)).style.display="block",e.style.opacity=0,e.style.height="auto",t.appendChild(e);var n=e.offsetHeight;return t.removeChild(e),n},t.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)},t.dataset=function(e,t,n){if(!I(n))return e.getAttribute("data-"+t);e.setAttribute("data-"+t,n)},t.target=function(e){return e.target||e.srcElement},t.createIframe=function(e){var t;if((e=e||{}).name)try{(t=document.createElement('<iframe name="'+e.name+'"></iframe>')).frameBorder=0}catch(n){(t=document.createElement("iframe")).name=e.name}else t=document.createElement("iframe");e.visible||(t.style.display="none");C(e.onload)&&x(t,"load",function n(i){if(!t.src)return;e.multi||k(t,"load",n);e.onload(i)});(e.parent||document.body).appendChild(t);var n=e.src||"about:blank";return setTimeout(function(){t.src=n},0),t},t.html2node=function(e){var t=document.createElement("div");t.innerHTML=e;var n=[],i=void 0,o=void 0;if(t.children)for(i=0,o=t.children.length;i<o;i++)n.push(t.children[i]);else for(i=0,o=t.childNodes.length;i<o;i++){var r=t.childNodes[i];1===r.nodeType&&n.push(r)}return n.length>1?t:n[0]},t.scrollTop=function(e){I(e)&&(document.documentElement.scrollTop=document.body.scrollTop=e);return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},t.forOwn=D,t.mixin=L,t.isJSON=j,t.parseJSON=function e(t){try{j(t)&&(t=JSON.parse(t)),M(t)&&D(t,function(n,i){switch(y(i)){case"string":case"object":t[n]=e(i)}})}catch(e){console.error(e)}return t},t.simpleClone=function(e){var t=[],n=JSON.stringify(e,function(e,n){if("object"===(void 0===n?"undefined":(0,r.default)(n))&&null!==n){if(-1!==t.indexOf(n))return;t.push(n)}return n});return JSON.parse(n)},t.merge=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.forEach(function(t){L(e,t)}),e},t.fillUndef=function(e,t){return D(t,function(t,n){w(e[t])&&(e[t]=n)}),e},t.checkWithDefault=function(e,t,n){var i=e[t]||e[t.toLowerCase()];A(i)&&(i=n,e[t]=i);return i},t.fetch=function(e,t){return D(e,function(n,i){I(t[n])&&(e[n]=t[n])}),e},t.string2object=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",",n={};return e.split(t).forEach(function(e){var t=e.split("="),i=t.shift();i&&(n[decodeURIComponent(i)]=decodeURIComponent(t.join("=")))}),n},t.object2string=W,t.genUrlSep=function(e){return e.indexOf("?")<0?"?":"&"},t.object2query=function(e){return W(e,"&",!0)},t.isFileInput=B,t.getKeys=function(e,t){var n=Object.keys(e);t&&n.sort(function(t,n){var i=B(e[t]),o=B(e[n]);return i===o?0:i?1:-1});return n};t.o={},t.emptyObj={},t.f=function(){},t.emptyFunc=function(){},t.regBlank=/\s+/gi,t.regWhiteSpace=/\s+/gi;function a(){return"undefined"!=typeof window?window:void 0!==e?e:{}}function s(e,t){t=t||2;for(var n=""+e;n.length<t;)n="0"+n;return n}function c(e){return""+e.getFullYear()}function u(e){return s(e.getMonth()+1)}function l(e){return s(e.getDate())}function f(e){return s(e.getHours())}function d(e){return s(e.getMinutes())}function p(e){return s(e.getSeconds())}function h(e){return s(e.getMilliseconds(),3)}var b,g;t.format=(b=/yyyy|MM|dd|hh|mm|ss|SSS/g,g={yyyy:c,MM:u,dd:l,hh:f,mm:d,ss:p,SSS:h},function(e,t){return e=new Date(e),isNaN(+e)?"invalid date":(t=t||"yyyy-MM-dd").replace(b,function(t){return g[t](e)})});function v(e){return Object.prototype.toString.call(e).slice(8,-1)}function y(e){return v(e).toLowerCase()}function m(e){return"string"===y(e)}function _(e){return"array"===y(e)}function C(e){return"function"===y(e)}function S(e){return"date"===y(e)}function O(e){return null===e}function T(e){return null!==e}function w(e){return void 0===e}function E(e){return void 0!==e}function I(e){return E(e)&&T(e)}function A(e){return w(e)||O(e)}function M(e){return I(e)&&"object"===y(e)}var N=t.addEventListener=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},x=t.on=N,P=t.removeEventListener=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},k=t.off=P;function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments[2];for(var i in e)e.hasOwnProperty(i)&&t.call(n,i,e[i])}function L(e,t){D(t,function(t,n){e[t]=n})}var R;t.uniqueID=(R=0,function(){return""+R++});function j(e){return m(e)&&0===e.indexOf("{")&&e.lastIndexOf("}")===e.length-1}function W(e,t,n){if(!e)return"";var i=[];return D(e,function(e,t){C(t)||(S(t)?t=t.getTime():_(t)?t=t.join(","):M(t)&&(t=JSON.stringify(t)),n&&(t=encodeURIComponent(t)),i.push(encodeURIComponent(e)+"="+t))}),i.join(t||",")}t.url2origin=function(){var e=/^([\w]+?:\/\/.*?(?=\/|$))/i;return function(t){return e.test(t||"")?RegExp.$1.toLowerCase():""}}();function B(e){var t=a();return e.tagName&&"INPUT"===e.tagName.toUpperCase()||t.Blob&&e instanceof t.Blob}}).call(this,n(27))},function(e,t,n){"use strict";var i=Object.prototype.hasOwnProperty,o="~";function r(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(o=!1)),s.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)i.call(e,t)&&n.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},s.prototype.listeners=function(e,t){var n=o?o+e:e,i=this._events[n];if(t)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,s=new Array(a);r<a;r++)s[r]=i[r].fn;return s},s.prototype.emit=function(e,t,n,i,r,a){var s=o?o+e:e;if(!this._events[s])return!1;var c,u,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,r),!0;case 6:return l.fn.call(l.context,t,n,i,r,a),!0}for(u=1,c=new Array(f-1);u<f;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var d,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,i);break;default:if(!c)for(d=1,c=new Array(f-1);d<f;d++)c[d-1]=arguments[d];l[u].fn.apply(l[u].context,c)}}return!0},s.prototype.on=function(e,t,n){var i=new a(t,n||this),r=o?o+e:e;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},s.prototype.once=function(e,t,n){var i=new a(t,n||this,!0),r=o?o+e:e;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},s.prototype.removeListener=function(e,t,n,i){var a=o?o+e:e;if(!this._events[a])return this;if(!t)return 0==--this._eventsCount?this._events=new r:delete this._events[a],this;var s=this._events[a];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||(0==--this._eventsCount?this._events=new r:delete this._events[a]);else{for(var c=0,u=[],l=s.length;c<l;c++)(s[c].fn!==t||i&&!s[c].once||n&&s[c].context!==n)&&u.push(s[c]);u.length?this._events[a]=1===u.length?u[0]:u:0==--this._eventsCount?this._events=new r:delete this._events[a]}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&(0==--this._eventsCount?this._events=new r:delete this._events[t])):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prototype.setMaxListeners=function(){return this},s.prefixed=o,s.EventEmitter=s,e.exports=s},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var i=n(52),o=n(35);e.exports=Object.keys||function(e){return i(e,o)}},,function(e,t,n){var i=n(6).f,o=n(7),r=n(2)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,r)&&i(e,r,{configurable:!0,value:t})}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var i=n(1),o=n(4),r=n(20),a=n(34),s=n(6).f;e.exports=function(e){var t=o.Symbol||(o.Symbol=r?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){t.f=n(2)},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var i=n(4),o=n(1),r=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n(20)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var i=n(36)("keys"),o=n(26);e.exports=function(e){return i[e]||(i[e]=o(e))}},function(e,t,n){var i=n(11);e.exports=function(e,t){if(!i(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!i(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(117);Object.defineProperty(t,"ajax",{enumerable:!0,get:function(){return a(i).default}});var o=n(129);Object.defineProperty(t,"element",{enumerable:!0,get:function(){return a(o).default}});var r=n(116);function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"tool",{enumerable:!0,get:function(){return a(r).default}})},function(e,t,n){var i=n(60);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,o){return e.call(t,n,i,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var i=n(9),o=n(90),r=n(35),a=n(37)("IE_PROTO"),s=function(){},c=function(){var e,t=n(48)("iframe"),i=r.length;for(t.style.display="none",n(72).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;i--;)delete c.prototype[r[i]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=i(e),n=new s,s.prototype=null,n[a]=e):n=c(),void 0===t?n:o(n,t)}},,,function(e,t,n){"use strict";t.__esModule=!0;var i,o=n(95),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}()},function(e,t,n){var i=n(11),o=n(1).document,r=i(o)&&i(o.createElement);e.exports=function(e){return r?o.createElement(e):{}}},function(e,t,n){"use strict";var i=n(92)(!0);n(55)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.constantBB=t.constantRtc=t.constantTool=void 0;var i,o,r,a,s,c=n(105),u=(i=c)&&i.__esModule?i:{default:i};var l={HANGUP_TYPE_NORMAL:0,HANGUP_TYPE_TIMEOUT:-1},f={NETCALL_TYPE_AUDIO:1,NETCALL_TYPE_VIDEO:2,DEVICE_TYPE_AUDIO_IN:0,DEVICE_TYPE_AUDIO_OUT_LOCAL:1,DEVICE_TYPE_AUDIO_OUT_CHAT:2,DEVICE_TYPE_VIDEO:3,DEVICE_TYPE_DESKTOP_SCREEN:4,DEVICE_TYPE_DESKTOP_WINDOW:5,CHAT_VIDEO_QUALITY_NORMAL:0,CHAT_VIDEO_QUALITY_LOW:1,CHAT_VIDEO_QUALITY_MEDIUM:2,CHAT_VIDEO_QUALITY_HIGH:3,CHAT_VIDEO_QUALITY_480P:4,CHAT_VIDEO_QUALITY_540P:5,CHAT_VIDEO_QUALITY_720P:6,CHAT_VIDEO_FRAME_RATE_NORMAL:0,CHAT_VIDEO_FRAME_RATE_5:1,CHAT_VIDEO_FRAME_RATE_10:2,CHAT_VIDEO_FRAME_RATE_15:3,CHAT_VIDEO_FRAME_RATE_20:4,CHAT_VIDEO_FRAME_RATE_25:5,LAYOUT_SPLITBOTTOMHORFLOATING:0,LAYOUT_SPLITTOPHORFLOATING:1,LAYOUT_SPLITLATTICETILE:2,LAYOUT_SPLITLATTICECUTTINGTILE:3,LAYOUT_SPLITCUSTOM:4,ROLE_PLAYER:0,ROLE_AUDIENCE:1};f.deviceTypeMap=(o={},(0,u.default)(o,f.DEVICE_TYPE_AUDIO_IN,"audioIn"),(0,u.default)(o,f.DEVICE_TYPE_AUDIO_OUT_CHAT,"audioOut"),(0,u.default)(o,f.DEVICE_TYPE_VIDEO,"video"),o),f.deviceTypeMap=(r={},(0,u.default)(r,f.DEVICE_TYPE_AUDIO_IN,"audioIn"),(0,u.default)(r,f.DEVICE_TYPE_AUDIO_OUT_LOCAL,"audioOut"),(0,u.default)(r,f.DEVICE_TYPE_AUDIO_OUT_CHAT,"audioOut"),(0,u.default)(r,f.DEVICE_TYPE_VIDEO,"video"),r),f.videoMap={frame:(a={},(0,u.default)(a,f.CHAT_VIDEO_QUALITY_NORMAL,"480x320"),(0,u.default)(a,f.CHAT_VIDEO_QUALITY_LOW,"176x144"),(0,u.default)(a,f.CHAT_VIDEO_QUALITY_MEDIUM,"352x288"),(0,u.default)(a,f.CHAT_VIDEO_QUALITY_HIGH,"480x320"),(0,u.default)(a,f.CHAT_VIDEO_QUALITY_480P,"640x480"),(0,u.default)(a,f.CHAT_VIDEO_QUALITY_540P,"960x540"),(0,u.default)(a,f.CHAT_VIDEO_QUALITY_720P,"1280x720"),a),frameRate:(s={},(0,u.default)(s,f.CHAT_VIDEO_FRAME_RATE_NORMAL,15),(0,u.default)(s,f.CHAT_VIDEO_FRAME_RATE_5,5),(0,u.default)(s,f.CHAT_VIDEO_FRAME_RATE_10,10),(0,u.default)(s,f.CHAT_VIDEO_FRAME_RATE_15,15),(0,u.default)(s,f.CHAT_VIDEO_FRAME_RATE_20,20),(0,u.default)(s,f.CHAT_VIDEO_FRAME_RATE_25,25),s)};var d={getVideoSessionConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.quality,n=void 0===t?f.CHAT_VIDEO_QUALITY_NORMAL:t,i=e.frameRate,o=void 0===i?f.CHAT_VIDEO_FRAME_RATE_NORMAL:i,r={},a=f.videoMap.frame[n];return r.frameRate=f.videoMap.frameRate[o],r.width=+a.split("x")[0],r.height=+a.split("x")[1],r},getDeviceTypeStr:function(e){return f.deviceTypeMap[e]},getDeviceTypeMap:function(e){return f.deviceTypeMap[e]}},p=Object.assign(f,{NETCALL_CONTROL_COMMAND_NOTIFY_AUDIO_ON:1,NETCALL_CONTROL_COMMAND_NOTIFY_AUDIO_OFF:2,NETCALL_CONTROL_COMMAND_NOTIFY_VIDEO_ON:3,NETCALL_CONTROL_COMMAND_NOTIFY_VIDEO_OFF:4,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO:5,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_AGREE:6,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_REJECT:7,NETCALL_CONTROL_COMMAND_SWITCH_VIDEO_TO_AUDIO:8,NETCALL_CONTROL_COMMAND_BUSY:9,NETCALL_CONTROL_COMMAND_SELF_CAMERA_INVALID:10,NETCALL_CONTROL_COMMAND_SELF_AUDIO_INVALID:11,NETCALL_CONTROL_COMMAND_SELF_ON_BACKGROUND:12,NETCALL_CONTROL_COMMAND_START_NOTIFY_RECEIVED:13,NETCALL_CONTROL_COMMAND_NOTIFY_RECORD_START:14,NETCALL_CONTROL_COMMAND_NOTIFY_RECORD_STOP:15},l),h=Object.assign({WB_TYPE_TCP:2,WB_TYPE_UDP:3,CALL_TYPE_NONE:0,CALL_TYPE_AUDIO:1,HANGUP_TYPE_NORMAL:0,HANGUP_TYPE_TIMEOUT:-1},{CONTROL_COMMAND_BUSY:9,CONTROL_COMMAND_SELF_ON_BACKGROUND:12,CONTROL_COMMAND_START_NOTIFY_RECEIVED:13},l);t.constantTool=d,t.constantRtc=p,t.constantBB=h},function(e,t,n){var i=n(52),o=n(35).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,o)}},function(e,t,n){var i=n(7),o=n(12),r=n(89)(!1),a=n(37)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),c=0,u=[];for(n in s)n!=a&&i(s,n)&&u.push(n);for(;t.length>c;)i(s,n=t[c++])&&(~r(u,n)||u.push(n));return u}},function(e,t,n){e.exports=n(10)},function(e,t,n){e.exports=!n(8)&&!n(16)(function(){return 7!=Object.defineProperty(n(48)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";var i=n(20),o=n(14),r=n(53),a=n(10),s=n(18),c=n(91),u=n(31),l=n(87),f=n(2)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,h,b,g,v){c(n,t,h);var y,m,_,C=function(e){if(!d&&e in w)return w[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",O="values"==b,T=!1,w=e.prototype,E=w[f]||w["@@iterator"]||b&&w[b],I=E||C(b),A=b?O?C("entries"):I:void 0,M="Array"==t&&w.entries||E;if(M&&(_=l(M.call(new e)))!==Object.prototype&&_.next&&(u(_,S,!0),i||"function"==typeof _[f]||a(_,f,p)),O&&E&&"values"!==E.name&&(T=!0,I=function(){return E.call(this)}),i&&!v||!d&&!T&&w[f]||a(w,f,I),s[t]=I,s[S]=p,b)if(y={values:O?I:C("values"),keys:g?I:C("keys"),entries:A},v)for(m in y)m in w||r(w,m,y[m]);else o(o.P+o.F*(d||T),t,y);return y}},,,function(e,t,n){n(86);for(var i=n(1),o=n(10),r=n(18),a=n(2)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<s.length;c++){var u=s[c],l=i[u],f=l&&l.prototype;f&&!f[a]&&o(f,a,u),r[u]=r.Array}},function(e,t,n){var i=n(39);e.exports=function(e){return Object(i(e))}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},,,,,,function(e,t,n){var i=n(28),o=n(19),r=n(12),a=n(38),s=n(7),c=n(54),u=Object.getOwnPropertyDescriptor;t.f=n(8)?u:function(e,t){if(e=r(e),t=a(t,!0),c)try{return u(e,t)}catch(e){}if(s(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t,n){var i=n(40),o=Math.min;e.exports=function(e){return e>0?o(i(e),9007199254740991):0}},function(e,t,n){var i=n(32);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o,r,a=n(105),s=(i=a)&&i.__esModule?i:{default:i};var c={CURRENT:{SDK_TYPE:null},SDK_TYPE:{NETCALL:1,WEBRTC:2,WHITEBOARD:3,NRTC:4},SDK_NAME:{1:"Netcall",2:"WebRTC",3:"WhiteBoard",4:"NRTC"}};c.STATS_FUN=(o={},(0,s.default)(o,c.SDK_TYPE.NETCALL,1),(0,s.default)(o,c.SDK_TYPE.WEBRTC,1),(0,s.default)(o,c.SDK_TYPE.NRTC,1),(0,s.default)(o,c.SDK_TYPE.WHITEBOARD,0),o),c.STATS_RTC=(r={},(0,s.default)(r,c.SDK_TYPE.WEBRTC,1),(0,s.default)(r,c.SDK_TYPE.NRTC,1),(0,s.default)(r,c.SDK_TYPE.WHITEBOARD,0),r),t.default=c,e.exports=t.default},,function(e,t){},function(e,t,n){var i=n(1).document;e.exports=i&&i.documentElement},,,function(e,t,n){n(33)("observable")},function(e,t,n){n(33)("asyncIterator")},function(e,t,n){var i=n(12),o=n(51).f,r={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==r.call(e)?function(e){try{return o(e)}catch(e){return a.slice()}}(e):o(i(e))}},function(e,t,n){var i=n(32);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){var i=n(29),o=n(43),r=n(28);e.exports=function(e){var t=i(e),n=o.f;if(n)for(var a,s=n(e),c=r.f,u=0;s.length>u;)c.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,n){var i=n(26)("meta"),o=n(11),r=n(7),a=n(6).f,s=0,c=Object.isExtensible||function(){return!0},u=!n(16)(function(){return c(Object.preventExtensions({}))}),l=function(e){a(e,i,{value:{i:"O"+ ++s,w:{}}})},f=e.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!r(e,i)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[i].i},getWeak:function(e,t){if(!r(e,i)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[i].w},onFreeze:function(e){return u&&f.NEED&&c(e)&&!r(e,i)&&l(e),e}}},function(e,t,n){"use strict";var i=n(1),o=n(7),r=n(8),a=n(14),s=n(53),c=n(80).KEY,u=n(16),l=n(36),f=n(31),d=n(26),p=n(2),h=n(34),b=n(33),g=n(79),v=n(78),y=n(9),m=n(11),_=n(12),C=n(38),S=n(19),O=n(44),T=n(77),w=n(66),E=n(6),I=n(29),A=w.f,M=E.f,N=T.f,x=i.Symbol,P=i.JSON,k=P&&P.stringify,D=p("_hidden"),L=p("toPrimitive"),R={}.propertyIsEnumerable,j=l("symbol-registry"),W=l("symbols"),B=l("op-symbols"),U=Object.prototype,H="function"==typeof x,F=i.QObject,Y=!F||!F.prototype||!F.prototype.findChild,V=r&&u(function(){return 7!=O(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(e,t,n){var i=A(U,t);i&&delete U[t],M(e,t,n),i&&e!==U&&M(U,t,i)}:M,K=function(e){var t=W[e]=O(x.prototype);return t._k=e,t},J=H&&"symbol"==typeof x.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof x},G=function(e,t,n){return e===U&&G(B,t,n),y(e),t=C(t,!0),y(n),o(W,t)?(n.enumerable?(o(e,D)&&e[D][t]&&(e[D][t]=!1),n=O(n,{enumerable:S(0,!1)})):(o(e,D)||M(e,D,S(1,{})),e[D][t]=!0),V(e,t,n)):M(e,t,n)},$=function(e,t){y(e);for(var n,i=g(t=_(t)),o=0,r=i.length;r>o;)G(e,n=i[o++],t[n]);return e},z=function(e){var t=R.call(this,e=C(e,!0));return!(this===U&&o(W,e)&&!o(B,e))&&(!(t||!o(this,e)||!o(W,e)||o(this,D)&&this[D][e])||t)},Q=function(e,t){if(e=_(e),t=C(t,!0),e!==U||!o(W,t)||o(B,t)){var n=A(e,t);return!n||!o(W,t)||o(e,D)&&e[D][t]||(n.enumerable=!0),n}},X=function(e){for(var t,n=N(_(e)),i=[],r=0;n.length>r;)o(W,t=n[r++])||t==D||t==c||i.push(t);return i},q=function(e){for(var t,n=e===U,i=N(n?B:_(e)),r=[],a=0;i.length>a;)!o(W,t=i[a++])||n&&!o(U,t)||r.push(W[t]);return r};H||(s((x=function(){if(this instanceof x)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(n){this===U&&t.call(B,n),o(this,D)&&o(this[D],e)&&(this[D][e]=!1),V(this,e,S(1,n))};return r&&Y&&V(U,e,{configurable:!0,set:t}),K(e)}).prototype,"toString",function(){return this._k}),w.f=Q,E.f=G,n(51).f=T.f=X,n(28).f=z,n(43).f=q,r&&!n(20)&&s(U,"propertyIsEnumerable",z,!0),h.f=function(e){return K(p(e))}),a(a.G+a.W+a.F*!H,{Symbol:x});for(var Z="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;Z.length>ee;)p(Z[ee++]);for(var te=I(p.store),ne=0;te.length>ne;)b(te[ne++]);a(a.S+a.F*!H,"Symbol",{for:function(e){return o(j,e+="")?j[e]:j[e]=x(e)},keyFor:function(e){if(!J(e))throw TypeError(e+" is not a symbol!");for(var t in j)if(j[t]===e)return t},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),a(a.S+a.F*!H,"Object",{create:function(e,t){return void 0===t?O(e):$(O(e),t)},defineProperty:G,defineProperties:$,getOwnPropertyDescriptor:Q,getOwnPropertyNames:X,getOwnPropertySymbols:q}),P&&a(a.S+a.F*(!H||u(function(){var e=x();return"[null]"!=k([e])||"{}"!=k({a:e})||"{}"!=k(Object(e))})),"JSON",{stringify:function(e){for(var t,n,i=[e],o=1;arguments.length>o;)i.push(arguments[o++]);if(n=t=i[1],(m(t)||void 0!==e)&&!J(e))return v(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!J(t))return t}),i[1]=t,k.apply(P,i)}}),x.prototype[L]||n(10)(x.prototype,L,x.prototype.valueOf),f(x,"Symbol"),f(Math,"Math",!0),f(i.JSON,"JSON",!0)},function(e,t,n){n(81),n(71),n(76),n(75),e.exports=n(4).Symbol},function(e,t,n){e.exports={default:n(82),__esModule:!0}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t){e.exports=function(){}},function(e,t,n){"use strict";var i=n(85),o=n(84),r=n(18),a=n(12);e.exports=n(55)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},function(e,t,n){var i=n(7),o=n(59),r=n(37)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),i(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var i=n(40),o=Math.max,r=Math.min;e.exports=function(e,t){return(e=i(e))<0?o(e+t,0):r(e,t)}},function(e,t,n){var i=n(12),o=n(67),r=n(88);e.exports=function(e){return function(t,n,a){var s,c=i(t),u=o(c.length),l=r(a,u);if(e&&n!=n){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}}},function(e,t,n){var i=n(6),o=n(9),r=n(29);e.exports=n(8)?Object.defineProperties:function(e,t){o(e);for(var n,a=r(t),s=a.length,c=0;s>c;)i.f(e,n=a[c++],t[n]);return e}},function(e,t,n){"use strict";var i=n(44),o=n(19),r=n(31),a={};n(10)(a,n(2)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(a,{next:o(1,n)}),r(e,t+" Iterator")}},function(e,t,n){var i=n(40),o=n(39);e.exports=function(e){return function(t,n){var r,a,s=String(o(t)),c=i(n),u=s.length;return c<0||c>=u?e?"":void 0:(r=s.charCodeAt(c))<55296||r>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):r:e?s.slice(c,c+2):a-56320+(r-55296<<10)+65536}}},function(e,t,n){n(49),n(58),e.exports=n(34).f("iterator")},function(e,t,n){e.exports={default:n(93),__esModule:!0}},function(e,t,n){e.exports={default:n(128),__esModule:!0}},function(e,t,n){"use strict";t.__esModule=!0;var i,o=n(141),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}},,,,,,,,,function(e,t,n){"use strict";t.__esModule=!0;var i,o=n(95),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(e,t,n){return t in e?(0,r.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(13),r=(i=o)&&i.__esModule?i:{default:i},a=n(41);var s=n(3).info.nrtcVersion,c=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.default)(this,e);var n=t.appkey,i=t.platform;this.apis={},this.isRtc=/WebRTC/.test(i),this.init(n,i),this.resetStatus()};t.default=c;var u=c.prototype;u.init=function(e,t){this.apis=Object.assign(this.apis,{ver:1,platform:t,sdk_ver:s||"v4.4.0",uid:null,appkey:e,time:null})},u.start=function(e){this.calling=!0,this.apis=Object.assign(this.apis,e)},u.resetStatus=function(){this.calling=!1,this.apis=Object.assign(this.apis,{p2p:{value:0},meeting:{value:0},bypass:{value:0},call_control_type:{value:0},self_mute:{value:-1},self_mic_mute:{value:-1},switch_p2p_type:{value:0},set_speaker:{value:-1},net_detect:{value:this.isRtc?-1:0},beautify:{value:-1},water_mark:{value:-1},audio_samples:{value:-1},video_samples:{value:-1},pre_view_mirror:{value:-1},code_mirror:{value:-1},custom_audio:{value:-1},custom_video:{value:-1},audio_mix:{value:-1},snap_shot:{value:-1},record:{value:0},audio_record:{value:0},display:{value:0},android_compatibility:{value:-1},hd_audio:{value:0},video_quality:{value:0},fps:{value:0},prefered_video_encoder:{value:-1},prefered_video_decoder:{value:-1},video_max_encode_bitrate:{value:this.isRtc?-1:0},audio_scene:{value:-1},video_adaptive_strategy:{value:this.isRtc?-1:0},ans:{value:this.isRtc?-1:0},agc:{value:-1},dtx:{value:-1},aec:{value:this.isRtc?-1:0},awc:{value:this.isRtc?-1:0}})},u.update=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=e.key,i=e.ext;e.constructor===String&&(n=e),i=i||t,this.apis[n]&&(this.apis[n].value=1,void 0!==i&&(this.apis[n].ext=i),/(p2p|meeting)/.test(n)&&(this.calling=!0))},u.send=function(){var e=this;this.calling&&(this.calling=!1,this.apis.time=Date.now(),(0,a.ajax)({type:"post",url:"https://statistic.live.126.net/statistic/realtime/sdkFunctioninfo",data:this.apis}).then(function(t){e.resetStatus()}).catch(function(t){console.log("err",t),e.resetStatus()}))},e.exports=t.default},,,,,,function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.default={merge:function(){var e=arguments;return e[0]=Object.assign.apply(Object.assign,arguments),e[0]},verifyOptions:function(){var e=arguments;if(e[0]&&e[0].constructor===Object)for(var t=1;t<arguments.length;t++){var n=e[t];(n=n.split(" ")).map(function(t){if(!e[0][t])throw Error("参数缺失 "+t)})}},guid:(i=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return i()+i()+i()+i()+i()+i()+i()+i()})},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e.url||!e.data)return Promise.reject("参数不完整，无法发起请求");e.dataType=e.dataType||"json";var t=new XMLHttpRequest;return t.open(e.type||"GET",e.url,!0),t.responseType=""+e.dataType,t.setRequestHeader("Content-type","application/json;charset=UTF-8"),e.header&&Object.keys(e.header).map(function(n){t.setRequestHeader(n,e.header[n])}),new Promise(function(n,i){t.onload=function(){var e=t.response;n(e)},t.onerror=function(e){i(e)},t.send(JSON.stringify(e.data))})};e.exports=t.default},,,,,,,,,,function(e,t,n){var i=n(14);i(i.S+i.F*!n(8),"Object",{defineProperty:n(6).f})},function(e,t,n){n(127);var i=n(4).Object;e.exports=function(e,t,n){return i.defineProperty(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={html2node:function(e){var t=document.createElement("div");t.innerHTML=e;var n,i,o=[];if(t.children)for(n=0,i=t.children.length;n<i;n++)o.push(t.children[n]);else for(n=0,i=t.childNodes.length;n<i;n++){var r=t.childNodes[n];1===r.nodeType&&o.push(r)}return o.length>1?t:o[0]},n2node:function(e){return e?/HTML.+Element/gi.test(e)?e:e[0]&&/HTML.+Element/gi.test(e[0])?e[0]:null:null}},e.exports=t.default},function(e,t,n){var i=n(14);i(i.S,"Object",{create:n(44)})},function(e,t,n){n(130);var i=n(4).Object;e.exports=function(e,t){return i.create(e,t)}},function(e,t,n){e.exports={default:n(131),__esModule:!0}},function(e,t,n){var i=n(11),o=n(9),r=function(e,t){if(o(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{(i=n(42)(Function.call,n(66).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return r(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:r}},function(e,t,n){var i=n(14);i(i.S,"Object",{setPrototypeOf:n(133).set})},function(e,t,n){n(134),e.exports=n(4).Object.setPrototypeOf},function(e,t,n){e.exports={default:n(135),__esModule:!0}},function(e,t,n){"use strict";var i=n(24),o=n(15),r=i.getGlobal();function a(e,t){for(var n in t)e[n]=t[n];return e}r.Object.assign||(console.log("Object.assign polyfill"),r.Object.assign=function(){for(var e=arguments,t=1;t<e.length;t++)e[0]=a(e[0],e[t]);return e[0]}),r.platform=o},function(e,t,n){"use strict";var i=n(29),o=n(43),r=n(28),a=n(59),s=n(68),c=Object.assign;e.exports=!c||n(16)(function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(e){t[e]=e}),7!=c({},e)[n]||Object.keys(c({},t)).join("")!=i})?function(e,t){for(var n=a(e),c=arguments.length,u=1,l=o.f,f=r.f;c>u;)for(var d,p=s(arguments[u++]),h=l?i(p).concat(l(p)):i(p),b=h.length,g=0;b>g;)f.call(p,d=h[g++])&&(n[d]=p[d]);return n}:c},function(e,t,n){var i=n(14);i(i.S+i.F,"Object",{assign:n(138)})},function(e,t,n){n(139),e.exports=n(4).Object.assign},function(e,t,n){e.exports={default:n(140),__esModule:!0}},,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.serializeWb={gateWay:{login:1,loginAck:2,join:3,keep_alive:4,keep_alive_ack:5,keep_alive_node:6,broadcast:7,toUser:8,logout:9}},t.unserializeWb={gateWay:{1:"login",2:"loginAck",3:"join",4:"keep_alive",5:"keep_alive_ack",6:"keep_alive_node",7:"broadcast",8:"toUser",9:"logout"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(13)),o=c(n(22)),r=c(n(21)),a=c(n(69)),s=n(153);function c(e){return e&&e.__esModule?e:{default:e}}var u=n(25),l=n(15),f=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.default)(this,t);var n=(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.info=Object.assign({},e),n.init(),n.logger=e.logger||window.console,n.autoReconnect=e.autoReconnect||!0,n.isDestroy=!1,n.reConnectCount=0,n.wssUrl=null,n}return(0,r.default)(t,e),t}(u),d=f.prototype;d.init=function(){this.reset()},d.reset=function(){this.imInfo={}},d.connect=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.url,i=void 0===n?this.wssUrl:n,o=t.imInfo;return this.imInfo=o||this.imInfo,i?new Promise(function(t,n){e.url=i;var o=void 0;try{o=e.ws=new WebSocket("wss://"+i);var r=e;o.onopen=function(n){e.wssUrl=i,r.initSignal(),r.signalConnected=!0,console.log("signalConnected",i),r.emit("signalConnected"),t(r),e.heartbeat()},o.onclose=o.onerror=function(e){r.signalConnected=!1,n(e)}}catch(t){e.logger.error("信令连接建立失败",t),n(t)}}):Promise.reject("信令地址缺失")},d.initSignal=function(){var e=this,t=this.ws,n=t.send;t.send=function(e){n.call(this,JSON.stringify(e))},t.onmessage=function(t){var n=JSON.parse(t.data||null);n&&(!e.isHeartBeating||"keep_alive_ack"!==n.type&&n.type!==s.serializeWb.gateWay.keep_alive_ack?e.emit("message",n):e.onHeartBeat(n))},t.onclose=function(t){e.signalConnected=!1,e.emit("signalTimeout",t)},t.onerror=function(t){e.signalConnected=!1,e.emit("signalTimeout",event)}},d.send=function(e){var t=this;e.type,this.ws&&this.signalConnected&&this.ws.readyState===this.ws.OPEN?(e.browser={},e.browser.name=l.name,e.browser.version=l.version,this.ws.send(e)):this.once("signalConnected",function(){t.send(e)})},d.heartbeat=function(){this.socketData=this.socketData||{uid:this.imInfo.uid,cid:this.imInfo.cid},this.heartBeatList=[],this.bindHearBeat(5)},d.onHeartBeat=function(e){this.heartBeatList.shift(),this.bindHearBeat(5)},d.heartBeatHandler=function(){var e=this.socketData,t=this.heartBeatList;if(t){var n=Date.now(),i=n;if(a.default.CURRENT.SDK_TYPE===a.default.SDK_TYPE.WHITEBOARD&&(i=+n.toString().slice(0,-3)),t.constructor===Array&&0===t.length){t.push(n);var o=this.getContentData({type:"keep_alive",uid:a.default.CURRENT.SDK_TYPE===a.default.SDK_TYPE.WHITEBOARD?+e.uid:e.uid+"",cid:a.default.CURRENT.SDK_TYPE===a.default.SDK_TYPE.WHITEBOARD?+e.cid:e.cid+""},i);return this.send(o),void this.bindHearBeat(5)}var r=Date.now()-t[0];if(r>3e4)this.logger.error("socket error: heartbeat timeout"),this.emit("signalTimeout");else if(r>2e3&&r<3e4){this.logger.warn("socket error: no response, keep heartbeat"),t.push(n);var s=this.getContentData({type:"keep_alive",uid:e.uid,cid:e.cid},i);this.send(s),this.bindHearBeat(2)}}},d.getContentData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return a.default.CURRENT.SDK_TYPE===a.default.SDK_TYPE.WHITEBOARD?(e.version=31,e.type=s.serializeWb.gateWay[e.type],e.content={params:{timestamp:+t}}):e.params={content:{timestamp:t+""}},e},d.bindHearBeat=function(e){this.isHeartBeating&&clearTimeout(this.isHeartBeating),this.isHeartBeating=setTimeout(this.heartBeatHandler.bind(this),1e3*e)},d.stopHeartBeat=function(){this.isHeartBeating&&(this.isHeartBeating&&clearTimeout(this.isHeartBeating),this.heartBeatTimer&&clearInterval(this.heartBeatTimer),this.isHeartBeating=null,this.heartBeatTimer=null,this.heartBeatList=null,this.heartBeatCount=0)},d.logout=function(){var e=this.socketData,t=Date.now().toString(),n=this.getContentData({type:"logout",uid:e.uid,cid:e.cid},t);this.send(n)},d.destroy=function(){this.logger.log("signal close -> signal.js"),this.stopHeartBeat(),this.isDestroy=!0,this.ws&&(this.ws.onopen=null,this.ws.onmessage=null,this.ws.onerror=null,this.ws.onclose=null,this.ws.readyState===WebSocket.OPEN&&this.ws.close(),this.ws=null)},t.default=f,e.exports=t.default},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(13)),o=l(n(47)),r=l(n(22)),a=l(n(21)),s=l(n(154)),c=l(n(69)),u=l(n(110));function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.info={},n._init(e),n._reset(),n}return(0,a.default)(t,e),(0,o.default)(t,[{key:"_init",value:function(e){this.info=Object.assign(this.info,e),this.logger=e.logger||window.console,c.default.STATS_RTC[c.default.CURRENT.SDK_TYPE]&&(this.dataApi=function(e){return new u.default(e)}({appkey:this.info.appKey,platform:c.default.SDK_NAME[c.default.CURRENT.SDK_TYPE]}))}},{key:"_reset",value:function(){this.signal&&(this.signal.destroy(),this.signal=null),this.sessionConfig={},this.imInfo={},this.target={},this.userJoinTimeoutId=0,this.remoteNodeStatus={}}},{key:"resetStatus",value:function(){this._reset()}},{key:"_startSession",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.imInfo||e;t.uid=+t.uid,t.cid=+t.cid,this.setSessionConfig(t.sessionConfig);var n=t.serverMap||{};t.urlArray=t.serverAddrs&&JSON.parse(JSON.stringify(t.serverAddrs))||n.webrtcarray&&JSON.parse(JSON.stringify(n.webrtcarray))||[n.webrtc];return this.signal?Promise.resolve(this.signal):this._initSignal()}},{key:"_initSignal",value:function(){var e=this;if(this.signal)return Promise.resolve();var t=new s.default({logger:this.logger}),n=this.imInfo.urlArray;if(n){var i=n.shift();return i?t.connect({url:i,imInfo:this.imInfo}).then(function(t){return e.signal=t,e._initSignalEvent(),t.emit("connected"),Promise.resolve(t.url)}).catch(function(t){return e._initSignal()}):Promise.reject("无可用的网关服务器地址, 如果当前应用是WebRTC音视频, 请确保对方打开了WebRTC兼容开关")}}},{key:"_initSignalEvent",value:function(){var e=this,t=this.signal;t.on("signalTimeout",this.onSignalTimeout.bind(this)),t.on("message",this.onSignalMessage.bind(this)),t.on("connected",function(){e.emit("connected")}),t.on("signalClosed",function(){e.emit("signalClosed"),e.resetStatus()}),this.signal.on("signalError",function(t){e.emit("signalClosed"),e._stopSignal()})}},{key:"_stopSignal",value:function(){this.signal&&(this.signal.destroy(),this.signal=null)}},{key:"_stopSession",value:function(){this._stopSignal(),this._reset()}},{key:"_logout",value:function(){this.signal&&this.signal.logout()}},{key:"setAppKey",value:function(e){e&&(this.info.appKey=e)}},{key:"setSessionConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionConfig=Object.assign(this.sessionConfig,e)}},{key:"onSignalMessage",value:function(e){}},{key:"onSignalTimeout",value:function(e){}},{key:"uploadDataApi",value:function(e,t){c.default.STATS_FUN[c.default.CURRENT.SDK_TYPE]&&this.info.appKey&&("start"===e&&(t.appkey=this.info.appKey),this.dataApi[e]&&this.dataApi[e](t))}}]),t}(n(25));t.default=f,e.exports=t.default},function(e,t,n){"use strict";var i=s(n(13)),o=s(n(22)),r=s(n(21)),a=n(41);function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,i.default)(this,t);var n=(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.container=a.element.n2node(e.container),e.remoteContainer=a.element.n2node(e.remoteContainer),a.tool.merge(n,e),n.init(),n}return(0,r.default)(t,e),t}(n(25)),u=c.prototype;u.init=function(){var e=this;this.resetStatus(),window.addEventListener("beforeunload",this.beforeunload.bind(this));var t=this.nim&&this.nim.logger||window.console;this.logger={log:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.debug&&t.log.apply(t,arguments)},error:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.debug&&t.error.apply(t,arguments)},warn:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.debug&&t.warn.apply(t,arguments)}}},u.resetStatus=function(){this.signalInited=!1,this.channelId=null,this.type=null,this.target={account:null,uid:null},this.sessionConfig={},this.sessionMode=null,this.imInfo={},this.calling=!1,this.isCaller=!1,this.callee=null,this.callAccepted=!1,this.callerInfo=null,this.beCalledInfo=null,this.nim&&(this.nim.protocol&&this.nim.protocol.setCurrentNetcall&&this.nim.protocol.setCurrentNetcall(),this.nim.protocol&&this.nim.protocol.setCurrentWhiteBoard&&this.nim.protocol.setCurrentWhiteBoard()),this.needQueryAccountMap={},this.accountUidMap={},this.uidAccountMap={},this.isOnHangup=!1},u.beforeunload=function(){this.signalInited&&(this.callerInfo||this.beCalledInfo?this.hangup():this.leaveChannel())},u.baseGetAccount=function(){return this.nim&&this.nim.account},u.baseGetUid=function(){return this.accountUidMap&&this.accountUidMap[this.nim.account]||"-1"},u.parseAccountUidMap=function(e){var t=this;Object.keys(e).forEach(function(n){t.addAccountUidMap({account:n,uid:e[n]})})},u.addAccountUidMap=function(e){var t=e.account,n=e.uid;this.uidAccountMap||(this.uidAccountMap={}),this.uidAccountMap[n]=t,this.accountUidMap||(this.accountUidMap={}),this.accountUidMap[t]=n},u.getAccountWithUid=function(e){if(this.uidAccountMap)return this.uidAccountMap[e]},u.getUidWithAccount=function(e){if(this.accountUidMap)return this.accountUidMap[e]},u.baseIsCurrentChannelId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.channelId&&this.channelId===e.channelId},u.baseNotCurrentChannelId=function(e){return!this.baseIsCurrentChannelId(e)},u.baseResponse=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.fn||"calleeAck",i=t.beCalledInfo||this.beCalledInfo,o=i.accepted=!1!==t.accepted;return o?(this.sessionMode="p2p",this.type=i.type,this.channelId=i.channelId,this.target.account=i.account,this.calling=!0,this.imInfo=i,this.imInfo.sessionMode=this.sessionMode,this.imInfo.role=0,this.setSessionConfig({signalStartTime:Date.now()})):(this.logger.log("reject call",i),this.packNetcallRecord({type:i.type,channelId:i.channelId,isCaller:!1,target:i.account,recordType:"rejectNetcall"})),this.nim[n](i).then(function(){o&&(t.sessionConfig&&e.setSessionConfig(t.sessionConfig),e.beCalledInfo=i,e.initSession({beCalledInfo:i}))},function(t){throw e.logger.log(t),t})},u.baseControl=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.channelId=t.channelId||this.channelId,t.command&&t.channelId){this.controller.uploadDataApi("update",{key:"call_control_type"});var n=t.fn||"netcallControl";return t.type=t.command,this.nim[n](t).catch(function(t){e.logger.log(t)})}},u.baseHangup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controller.uploadDataApi("send");var t=e.channelId,n=void 0===t?this.channelId:t,i=e.recordType;if(n){var o=e.fn||"hangup";this.nim[o]({channelId:n})}n===this.channelId&&(this.isCaller&&!this.callAccepted&&(this.logger.log(i,{channelId:n}),this.packNetcallRecord({recordType:i})),this.resetWhenHangup())},u.baseStartSession=function(){this.imInfo.cid=this.imInfo.cid||this.imInfo.channelId;var e=this.sessionMode=this.sessionMode||"p2p";this.imInfo.sessionMode=e,this.imInfo.sessionConfig=this.sessionConfig,this.imInfo.serverMap&&this.imInfo.serverMap.constructor===String&&(this.imInfo.serverMap=JSON.parse(this.imInfo.serverMap))},u.packNetcallRecord=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.recordType,n=e.type||this.type,i=e.channelId||this.channelId,o=e.duration||0,r=e.isCaller||this.isCaller,s=e.target||this.target.account,c=this.baseGetAccount(),u=r?c:s,l=r?s:c,f=+new Date;this.nim.protocol.onMsg({content:{msg:{attach:JSON.stringify({data:{calltype:n,channel:i,duration:o,ids:[c,s],time:f},id:t}),from:u,fromClientType:r?16:0,fromDeviceId:"",fromNick:"",idClient:a.tool.guid(),idServer:a.tool.guid(),scene:0,time:f,to:l,type:5}}})},u.setSessionConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.tool.merge(this.sessionConfig,e)},u.initSignal=function(){return Promise.resolve()},u.initSession=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionMode="p2p";var n=this.isCaller?this.callerInfo:t.beCalledInfo;this.parseAccountUidMap(n.accountUidMap),!n.account&&n.uid&&(n.account=this.getAccountWithUid(n.uid)),this.callAccepted=!0,this.signalInited=!0,this.setSessionConfig({signalEndTime:Date.now()}),this.controller.uploadDataApi("start",{uid:n.uid}),this.target.uid=this.getUidWithAccount(this.target.account);var i={type:n.type,account:this.target&&this.target.account||n.account,channelId:n.channelId};n.netcallType&&(i.netcallType=n.netcallType),this.imInfo.target=this.target,setTimeout(function(){e.emit("callAccepted",i)},1)},u.onBeCalled=function(e){this.signalInited=!0,this.channelId=e.channelId,this.beCalledInfo=e,this.logger.log("beCalling",e),this.emit("beCalling",e)},u.onUserJoin=function(e){if(this.logger.log("client on userJoined",e),e.type=e.type||this.type,e.account=this.getAccountWithUid(e.uid),e.mode=this.sessionMode,e.account!==this.baseGetAccount()){if(e.account)return this.logger.log("userjoin ----\x3e from signal",e),void this.emit("joinChannel",e);this.needQueryAccountMap[e.uid]=e,(this.nim.queryAccountUidMap||this.nim.wbQueryAccountUidMap).call(this.nim,this.channelName,[e.uid])}},u.onUserLeft=function(e){var t=this;this.imInfo.channelId&&(this.logger.log("leave channel from signal"),"p2p"===this.imInfo.sessionMode?(this.controller.uploadDataApi("send"),setTimeout(function(){t.logger.log("超时处理 onUserLeft"),t.resetWhenHangup()},1e3),this.emit("hangup",{channelId:e.channelId||e.cid,account:this.target.account,type:e.type||0})):this.emit("leaveChannel",{channelId:e.channelId||e.cid,account:this.getAccountWithUid(e.uid),type:e.type||0}))},u.onNotifyJoin=function(e){if(this.logger){this.logger.log("join channel from IM");var t=e.accountUidMap,n=this.needQueryAccountMap;for(var i in this.parseAccountUidMap(t),t){var o=i,r=t[i];if(r in n){var a=n[r];a.account=o,delete n[r],this.logger.log("userjoin ----\x3e from IM",e),this.emit("joinChannel",a)}}}},u.onCalleeAck=function(e){if(this.logger.log("收到被叫的通知",e),!this.baseNotCurrentChannelId(e)){var t=e.account,n=this.beCalledInfo||this.callerInfo;this.target.account=t,this.setSessionConfig({signalEndTime:Date.now()}),e.accepted?(this.callAccepted=!0,this.initSession()):(this.logger.log("call Rejected",e),this.packNetcallRecord({type:e.type,channelId:e.channelId,isCaller:!0,target:e.account,recordType:"netcallRejected"}),this.resetWhenHangup(),this.emit("callRejected",{type:n.type,account:t}))}},u.onHangup=function(e){var t=this;this.channelId&&"p2p"===this.sessionMode&&(this.logger.log("on hangup from IM"),this.controller.uploadDataApi("send"),setTimeout(function(){t.logger.log("超时处理 onHangup"),t.resetWhenHangup()},1e3),this.emit("hangup",{channelId:e.channelId,account:e.account,type:0}))},u.onControl=function(e){this.emit("control",e)},u.onCalleeAckSync=function(e){this.emit("callerAckSync",e),this.baseIsCurrentChannelId(e)&&this.resetWhenHangup()},u.baseCreateChannel=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.tool.verifyOptions(n,"channelName"),n.custom=n.custom||"",this.setSessionConfig({signalStartTime:Date.now()}),this.nim[e](n).then(function(e){return Promise.resolve(e)}).catch(function(e){return t.setSessionConfig({signalEndTime:Date.now()}),Promise.reject(e)})},u.baseJoinChannel=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.nim[e](n).then(function(e){return t.setSessionConfig({signalEndTime:Date.now()}),t.signalInited=!0,t.sessionMode=e.sessionMode="meeting",t.parseAccountUidMap(e.accountUidMap),e.uid=t.getUidWithAccount(t.nim.account),Promise.resolve(e)}).catch(function(e){return t.setSessionConfig({signalEndTime:Date.now()}),Promise.reject(e)})},u.format=function(e){return e.rtcServerMap&&(e.rtcServerMap=JSON.parse(e.rtcServerMap),e.rtcServerMap=e.rtcServerMap.webrtcarray||[e.rtcServerMap.webrtc]||e.rtcServerMap),e.wbServerMap&&(e.wbServerMap=JSON.parse(e.wbServerMap),e.wbServerMap=e.wbServerMap.webrtcarray||[e.wbServerMap.webrtc]||e.wbServerMap),e},u.resetWhenHangup=function(){},e.exports=c},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.util;return i=t.notundef,o};var i=void 0;function o(e){i(e.enable)&&(this.enable=e.enable?1:0),i(e.needBadge)&&(this.needBadge=e.needBadge?1:0),i(e.needPushNick)&&(this.needPushNick=e.needPushNick?1:0),i(e.pushContent)&&(this.pushContent=""+e.pushContent),i(e.custom)&&(this.custom=""+e.custom),i(e.pushPayload)&&(this.pushPayload=""+e.pushPayload),i(e.sound)&&(this.sound=""+e.sound),i(e.webrtcEnable)&&(this.webrtcEnable=e.webrtcEnable?1:0)}e.exports=t.default},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(13)),o=l(n(22)),r=l(n(21)),a=l(n(165)),s=n(153),c=n(50),u=n(41);function l(e){return e&&e.__esModule?e:{default:e}}var f=null,d=function(e){function t(e){(0,i.default)(this,t);var n=(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.logger=e.logger||{},n.resetStatus(),n}return(0,r.default)(t,e),t}(a.default);t.default=d;var p=d.prototype;p.resetStatus=function(){this.nodeTimer&&(clearInterval(this.nodeTimer),this.nodeTimer=null),this.reConnectCount=0,this.recv_bytes=0,this.send_bytes=0},p.startSession=function(e){return this.imInfo=e||this.imInfo,this.connect()},p.connect=function(){var e=this;return this._startSession().then(function(t){return f=t,e.reConnectCount=0,new Promise(function(t,n){e.wbLogin(),e.once("LoginSuccess",function(n){e.logger.log("once LoginSuccess--\x3e",n),t(f)}),e.once("LoginFailed",function(t){e.logger.log("once LoginFailed--\x3e",t),n(t)})})})},p.destroy=function(){this.stopSession()},p.stopSession=function(){return this.wbLogout(),this._stopSession(),this.resetStatus(),Promise.resolve()},p.setSessionConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u.tool.merge(this.sessionConfig,e)},p.wbLogin=function(){var e={token:this.imInfo.cid,client_type:2,client_net:2,client_os:6,client_support_record:~~this.sessionConfig.record};this.sendMsg(s.serializeWb.gateWay.login,e)},p.wbLogout=function(){var e={timestamp:Date.now(),recv_bytes:this.recv_bytes,send_bytes:this.send_bytes};this.sendMsg(s.serializeWb.gateWay.logout,e)},p.sendData=function(e){var t=e.data,n=e.toAccount,i=void 0===n?0:n;if(t){this.sendStats(t);var o={data:t};"0"===i&&(i=+i),"p2p"===this.imInfo.sessionMode?o.dst_client_id=this.target&&this.target.uid||0:i&&(o.dst_client_id=this.info.client.getUidWithAccount(i));var r=o.dst_client_id?s.serializeWb.gateWay.toUser:s.serializeWb.gateWay.broadcast;this.sendMsg(r,o)}},p.sendMsg=function(e,t){var n={type:e,uid:+this.imInfo.uid,cid:+this.imInfo.cid,version:31,content:{params:t}};this.signal&&this.signal.send(n)},p.onSignalMessage=function(e){if(e&&e.cid&&e.uid&&(e.cid=+e.cid,e.uid=+e.uid),e.cid!==this.imInfo.cid)return console.error("websocket message not belong to this session");var t=s.unserializeWb.gateWay[e.type];this["on"+t]&&this["on"+t](e)},p.onloginAck=function(e){var t=this,n=e.content.params.auth_result-0;if(200!==n)return this.logger.error("服务器验证不通过, 断开连接"),void this.emit("LoginFailed",{code:n,error:"服务器验证不通过, 断开连接"});this.logger.log("白板服务器登录成功",e),this.emit("LoginSuccess"),"p2p"===this.imInfo.sessionMode&&(this.logger.log("45s之内等待对方加入"),this.userJoinTimeoutId=setTimeout(function(){t.userJoinTimeoutId&&0===Object.keys(t.remoteNodeStatus).length&&t.emit("error",{error:"点对点对方登录超时, 断开连接"})},45e3))},p.onjoin=function(e){this.logger.log(e);var t=e.content&&e.content.params&&e.content.params.client_id;this.startNodeMonitor(t),"p2p"===this.imInfo.sessionMode&&(this.target={uid:t},this.userJoinTimeoutId&&clearTimeout(this.userJoinTimeoutId),this.userJoinTimeoutId=0),this.emit("userJoined",{uid:t,cid:e.cid})},p.onkeep_alive_node=function(e){var t=e.uid,n=this.remoteNodeStatus;n[t]=n[t]||{now:Date.now(),total:45},n[t].now=Date.now(),n[t].total=45},p.onlogout=function(e){this.logger.log("onlogout",e),this.emit("leaveChannel",{uid:e.uid,channelId:e.cid}),delete this.remoteNodeStatus[e.uid]},p.ontoUser=function(e){this.onData(e)},p.onbroadcast=function(e){this.onData(e)},p.onData=function(e){var t=e.content&&e.content.params&&e.content.params.data,n=e.uid;this.receiveStats(t);var i=void 0;try{i=JSON.parse(t||null)}catch(e){i=t}this.onkeep_alive_node({uid:n}),this.emit("data",{uid:n,data:i})},p.startNodeMonitor=function(e){var t=this,n=this.remoteNodeStatus;n[e]=n[e]||{now:Date.now(),total:45},n[e].now=Date.now(),this.nodeTimer||(this.nodeTimer=setInterval(function(){var i=Date.now();Object.keys(n).map(function(o){if(i-n[o].now>5e4||n[o].total<=0)return t.logger.warn("节点45s超时离开:",o),t.emit("leaveChannel",{uid:o,type:c.constantBB.HANGUP_TYPE_TIMEOUT,channelId:t.imInfo.cid}),delete t.remoteNodeStatus[e],void delete n[o];i-n[o].now>5e3&&(n[o].total-=5)})},5e3))},p.onSignalTimeout=function(){var e=this;this.emit("disconnected"),this.reConnectCount>=3?this.emit("signalClosed"):(this.reConnectCount++,this.emit("willReconnect",this.reConnectCount),this.logger.log("3s后尝试第"+this.reConnectCount+"次重连服务器"),this._stopSignal(),setTimeout(function(){e.imInfo&&e.imInfo.serverAddrs&&(e.logger.log("开始第"+e.reConnectCount+"次重连服务器"),f&&e.imInfo.serverAddrs.unshift(f),e.connect().then(function(){e.emit("connected",e.reConnectCount)}).catch(function(t){e.logger.error("reconnect error",t),e.onSignalTimeout()}))},3e3))},p.sendStats=function(e){this.send_bytes+=e.length},p.receiveStats=function(e){this.recv_bytes+=e.length},e.exports=t.default},,,,,,,,,,function(e,t,n){"use strict";e.exports={pushConfig:{1:"enable",2:"needBadge",3:"needPushNick",4:"pushContent",5:"custom",6:"pushPayload",7:"sound",10:"webrtcEnable"},liveOption:{1:"liveEnable",2:"webrtcEnable"},turnInfoTag:{0:"channelId",1:"tunnelServer",2:"proxyServer",3:"stunServer",4:"type",5:"dispatchServer"}}},function(e,t,n){"use strict";e.exports={pushConfig:{enable:1,needBadge:2,needPushNick:3,pushContent:4,custom:5,pushPayload:6,sound:7,webrtcEnable:10},liveOption:{liveEnable:1,webrtcEnable:2},turnInfoTag:{channelId:0,tunnelServer:1,proxyServer:2,stunServer:3,type:4,dispatchServer:5}}},function(e,t,n){"use strict";var i={wb:{id:11,initWhiteBoard:1,wbKeepCalling:2,wbCalleeAck:4,wbNotifyCalleeAck:5,wbHangup:8,wbNotifyHangup:9,wbControl:10,wbNotifyControl:11,wbNotifyRecord:12,wbCreateChannel:13,wbJoinChannel:14,wbNotifyJoin:15,wbQueryAccountUidMap:16}},o={initWhiteBoard:{sid:11,cid:i.wb.initWhiteBoard,params:[{type:"StrArray",name:"type"},{type:"StrArray",name:"accounts"},{type:"String",name:"pushContent"},{type:"String",name:"custom"},{type:"Property",name:"pushConfig"}]},wbKeepCalling:{sid:11,cid:i.wb.wbKeepCalling,params:[{type:"StrArray",name:"accounts"},{type:"long",name:"channelId"}]},wbCalleeAck:{sid:11,cid:i.wb.wbCalleeAck,params:[{type:"long",name:"channelId"},{type:"bool",name:"accepted"}]},wbHangup:{sid:11,cid:i.wb.wbHangup,params:[{type:"long",name:"channelId"}]},wbControl:{sid:11,cid:i.wb.wbControl,params:[{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"string",name:"info"}]},wbCreateChannel:{sid:11,cid:i.wb.wbCreateChannel,params:[{type:"String",name:"channelName"},{type:"String",name:"custom"},{type:"String",name:"webrtcEnable"}]},wbJoinChannel:{sid:11,cid:i.wb.wbJoinChannel,params:[{type:"String",name:"channelName"},{type:"Property",name:"liveOption"}]},wbQueryAccountUidMap:{sid:11,cid:i.wb.wbQueryAccountUidMap,params:[{type:"String",name:"channelName"},{type:"LongArray",name:"uids"}]}},r={"11_1":{service:"datatun",cmd:"initWhiteBoard",response:[{type:"Number",name:"timetag"},{type:"Number",name:"uid"},{type:"Number",name:"channelId"},{type:"PropertyArray",name:"turnInfoTag"},{type:"StrArray",name:"keepCallingAccounts"},{type:"StrLongMap",name:"accountUidMap"},{type:"bool",name:"p2p"},{type:"String",name:"clientConfig"}]},"11_2":{service:"datatun",cmd:"wbKeepCalling",response:[{type:"StrArr",name:"accounts"}]},"11_3":{service:"datatun",cmd:"wbBeCalled",response:[{type:"Number",name:"timetag"},{type:"String",name:"account"},{type:"Number",name:"channelId"},{type:"PropertyArray",name:"turnInfoTag"},{type:"StrLongMap",name:"accountUidMap"},{type:"bool",name:"p2p"},{type:"String",name:"custom"},{type:"Number",name:"uid"},{type:"String",name:"clientConfig"},{type:"Property",name:"pushConfig"}]},"11_4":{service:"datatun",cmd:"wbCalleeAck",response:[]},"11_5":{service:"datatun",cmd:"wbNotifyCalleeAck",response:[{type:"long",name:"channelId"},{type:"String",name:"account"},{type:"bool",name:"accepted"}]},"11_6":{service:"datatun",cmd:"wbNotifyCalleeAckSync",response:[{type:"String",name:"timetag"},{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"bool",name:"accepted"},{type:"byte",name:"fromClientType"}]},"11_7":{service:"datatun",cmd:"xxxx",response:[]},"11_8":{service:"datatun",cmd:"wbHangup",response:[]},"11_9":{service:"datatun",cmd:"wbNotifyHangup",response:[{type:"long",name:"timetag"},{type:"long",name:"channelId"},{type:"String",name:"account"}]},"11_10":{service:"datatun",cmd:"wbControl",response:[]},"11_11":{service:"datatun",cmd:"wbNotifyControl",response:[{type:"String",name:"account"},{type:"byte",name:"type"},{type:"string",name:"info"},{type:"long",name:"channelId"}]},"11_12":{service:"datatun",cmd:"wbNotifyRecord",response:[{type:"Property",name:"msg"}]},"11_13":{service:"datatun",cmd:"wbCreateChannel",response:[{type:"long",name:"timetag"}]},"11_14":{service:"datatun",cmd:"wbJoinChannel",response:[{type:"long",name:"timetag"},{type:"long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"},{type:"Property",name:"turnInfoTag"},{type:"String",name:"custom"}]},"11_15":{service:"datatun",cmd:"wbNotifyJoin",response:[{type:"Long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"}]},"11_16":{service:"datatun",cmd:"wbQueryAccountUidMap",response:[]}};e.exports={idMap:i,cmdConfig:o,packetConfig:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={getAccount:function(){return this.baseGetAccount()},getUid:function(){return this.baseGetUid()},isCurrentChannelId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.baseIsCurrentChannelId(e)},notCurrentChannelId:function(e){return!this.isCurrentChannelId(e)},startSession:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sessionStarted?Promise.resolve():(this.sessionStarted=!0,e.wssArr&&(this.imInfo.serverAddrs=e.wssArr.constructor===Array?e.wssArr:[e.wssArr]),this.baseStartSession(),this.controller.startSession(this.imInfo))},stopSession:function(){return this.resetWhenHangup(),Promise.resolve()},leaveChannel:function(){this.stopSession()},sendData:function(e){var t=e.data,n=e.toAccount,i=void 0===n?0:n;this.controller.sendData({data:t,toAccount:i})}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(13)),o=p(n(47)),r=p(n(22)),a=p(n(21)),s=p(n(69)),c=p(n(166)),u=p(n(349)),l=n(41),f=n(50),d=p(n(362));function p(e){return e&&e.__esModule?e:{default:e}}s.default.CURRENT.SDK_TYPE=s.default.SDK_TYPE.WHITEBOARD;var h=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.initWB(),n}return(0,a.default)(t,e),(0,o.default)(t,[{key:"initWB",value:function(){if(!this.nim)throw new Error({error:"请传入nim实例"});this.initProtocol(),this.initController()}},{key:"initProtocol",value:function(){var e=this.nim;e.on("wbBeCalled",this.onBeCalled.bind(this)),e.on("wbNotifyCalleeAck",this.onCalleeAck.bind(this)),e.on("wbNotifyHangup",this.onHangup.bind(this)),e.on("wbControl",this.onControl.bind(this)),e.on("wbNotifyCalleeAckSync",this.onCalleeAckSync.bind(this)),e.on("wbNotifyJoin",this.onNotifyJoin.bind(this))}},{key:"initController",value:function(){var e=this;window.myWbContrl=this.controller=new u.default({appKey:this.nim&&this.nim.options.appKey,debug:this.debug,container:this.container,logger:this.logger,client:this,isCustom:this.isCustom}),this.controller.on("userJoined",this.onUserJoin.bind(this)),this.controller.on("signalClosed",function(t){e.emit("signalClosed",t)}),this.controller.on("willReconnect",function(t){e.emit("willReconnect",t)}),this.controller.on("disconnected",function(t){e.emit("disconnected",t)}),this.controller.on("connected",function(t){e.emit("connected",t)}),this.controller.on("leaveChannel",this.onUserLeft.bind(this)),this.controller.on("error",function(t){e.emit("error",t)}),this.controller.on("customData",function(t){e.emit("customData",t)}),this.controller.on("data",function(t){e.emit("data",{account:e.getAccountWithUid(t.uid),data:t.data})}),window.addEventListener("beforeunload",this.beforeunload.bind(this))}},{key:"destroy",value:function(){var e=this;this.controller.destroy(),this.controller=null,this.nim=null,Object.keys(this).map(function(t){e[t]=null,delete e[t]})}},{key:"serializeType",value:function(e,t){return t&&t!==f.constantBB.CALL_TYPE_NONE?t!==f.constantBB.CALL_TYPE_AUDIO?[e]:[t,e]:[e]}},{key:"unserializeType",value:function(e){var t={},n=-1;return e.map(function(e,i){e===f.constantBB.CALL_TYPE_AUDIO&&(t.netcallType=f.constantBB.CALL_TYPE_AUDIO,n=i)}),-1!==n&&e.splice(t.i,1),t.type=e[0],t}},{key:"call",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.account,n=e.type,i=e.netcallType,o=e.pushConfig,r=e.sessionConfig;return this.calling=!0,this.isCaller=!0,this.callee=t,this.target.account=t,r&&(r.signalStartTime=Date.now(),this.controller.setSessionConfig(r)),this.initWhiteBoard({type:n,netcallType:i,pushConfig:o})}},{key:"initWhiteBoard",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.type,i=t.netcallType,o=t.pushConfig;this.type=n,this.netcallType=i||f.constantBB.CALL_TYPE_NONE,this.controller.setSessionConfig({signalStartTime:Date.now()});var r={type:this.serializeType(this.type,this.netcallType),accounts:[this.callee],pushConfig:o,webrtcEnable:!0};return this.nim.initWhiteBoard(r).then(function(t){e.signalInited=!0,e.sessionMode="p2p",e.logger.log("initWhiteBoard:",t),e.callerInfo=e.wbFormat(t),e.imInfo=e.callerInfo,e.imInfo.sessionMode=e.sessionMode,e.channelId=t.channelId,e.imInfo.role=0}).catch(function(t){return e.controller.setSessionConfig({signalEndTime:Date.now()}),e.resetWhenHangup(),Promise.reject(t)})}},{key:"response",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.fn="wbCalleeAck",this.baseResponse(e)}},{key:"control",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.fn="wbControl",this.baseControl(e)}},{key:"hangup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.fn="wbHangup",e.recordType="cancelWhiteBoardBeforeAccept",this.baseHangup(e)}},{key:"createChannel",value:function(e){return e.channelName?(e.custom=e.custom||"",this.baseCreateChannel("wbCreateChannel",e).then(function(e){return Promise.resolve(e)}).catch(function(e){return Promise.reject(e)})):Promise.reject("缺少参数 channelName")}},{key:"joinChannel",value:function(e){var t=this;if(this.signalInited)return Promise.reject("已经加入房间");if(!e.channelName)return Promise.reject("缺少参数 channelName");var n=e.sessionConfig;return n&&(l.tool.merge(this,{sessionConfig:n}),this.controller.setSessionConfig(n),this.controller.setSessionConfig({signalStartTime:Date.now()})),this.baseJoinChannel("wbJoinChannel",{channelName:e.channelName}).then(function(i){var o=void 0;return i.turnInfoTag&&(o=i.turnInfoTag.dispatchServer&&JSON.parse(i.turnInfoTag.dispatchServer)||i.turnInfoTag.tunnelServer),o&&o.constructor===String&&(o=o.split(";")),o&&o.constructor===Object&&(o=o.webrtcarray),i.serverAddrs=o||[],t.type=i.type=i.type,i.account=t.nim.account,i.sessionConfig=n,t.imInfo=i,t.imInfo.role=void 0===e.role?0:e.role,setTimeout(function(){t.sessionStarted||t.startSession(e)},200),Promise.resolve({uid:i.uid,account:t.nim.account,type:i.type})}).catch(function(e){return Promise.reject(e)})}},{key:"onBeCalled",value:function(e){e=this.wbFormat(e),this.channelId||(this.signalInited=!0,this.channelId=e.channelId,this.beCalledInfo=e,this.logger.log("beCalling",e)),this.emit("beCalling",e)}},{key:"wbFormat",value:function(e){var t=e.turnInfoTag;return t&&t.constructor===Array?(t.map(function(t){/[01]/.test(t.type)?(e.netcallType=t.type,e.rtcServerMap=t.dispatchServer,e.serverMap=JSON.parse(JSON.stringify(t.dispatchServer))):(e.type=t.type,e.wbServerMap=t.dispatchServer)}),e.netcallType=e.netcallType||f.constantBB.CALL_TYPE_NONE,(e=this.format(e)).serverAddrs=JSON.parse(JSON.stringify(e.wbServerMap))||[],e):e}},{key:"resetWhenHangup",value:function(){this.controller.stopSession(),this.resetStatus(),this.sessionStarted=!1}}]),t}(c.default),b=h.prototype;b=Object.assign(b,d.default),t.default=h,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return!!WebSocket},e.exports=t.default},function(e,t,n){"use strict";var i={install:function(e){var t=e.Protocol.fn;t.processDatatun=function(e){switch(e.cmd){case"initWhiteBoard":this.onWbInit(e);break;case"wbBeCalled":this.onWbBeCalled(e);break;case"wbKeepCalling":this.onWbKeepCalling(e);break;case"wbCalleeAck":break;case"wbNotifyCalleeAck":this.onWbNotifyCalleeAck(e);break;case"wbHangup":break;case"wbNotifyHangup":this.onWbNotifyHangup(e);break;case"wbNotifyControl":this.onWbControl(e);break;case"wbNotifyCalleeAckSync":this.onWbNotifyCalleeAckSync(e);break;case"wbNotifyRecord":case"wbCreateChannel":break;case"wbJoinChannel":this.wbJoinChannel(e);break;case"wbNotifyJoin":this.onWbNotifyJoin(e)}},t.onWbInit=function(e){if(!e.error){var t=e.obj.type;e.obj=e.content,e.obj.type=t,e.obj.accounts=e.obj.keepCallingAccounts,this.setCurrentWhiteBoard(e.obj.channelId),this.wbKeepCalling(e)}},t.setCurrentWhiteBoard=function(e){this.currentWhiteBoardChannelId=e},t.onWbKeepCalling=function(e){e.error||e.content.accounts.length&&this.wbKeepCalling(e)},t.wbKeepCalling=function(e){var t=this,n=e.obj,i=n.type,o=n.accounts,r=n.channelId;o&&o.length&&setTimeout(function(){t.currentWhiteBoardChannelId&&t.currentWhiteBoardChannelId===r&&t.api.wbKeepCalling({type:i,accounts:o,channelId:r}).catch(function(){})},3e3)},t.onWbBeCalled=function(e){e.error||this.emitAPI({type:"wbBeCalled",obj:e.content})},t.onWbNotifyCalleeAck=function(e){e.error||this.emitAPI({type:"wbNotifyCalleeAck",obj:e.content})},t.onWbNotifyHangup=function(e){e.error||this.emitAPI({type:"wbNotifyHangup",obj:e.content})},t.onWbControl=function(e){e.error||this.emitAPI({type:"wbControl",obj:e.content})},t.onWbNotifyCalleeAckSync=function(e){e.error||this.emitAPI({type:"wbNotifyCalleeAckSync",obj:e.content})},t.onWbNotifyJoin=function(e){e.error||this.emitAPI({type:"wbNotifyJoin",obj:e.content})},t.wbJoinChannel=function(e){e.obj=e.content}}};e.exports=i},function(e,t,n){"use strict";var i=n(169),o={install:function(e){var t=e.fn,n=e.util,o=i({util:n});t.initWhiteBoard=function(e){return n.verifyOptions(e,"type accounts","wb::initWhiteBoard"),e.pushContent="",e.custom="",e.pushConfig||(e.pushConfig={}),e.pushConfig.webrtcEnable=e.webrtcEnable,e.pushConfig=new o(e.pushConfig),this.cbAndSendCmd("initWhiteBoard",e)},t.wbKeepCalling=function(e){return n.verifyOptions(e,"type accounts channelId","wb::wbKeepCalling"),this.cbAndSendCmd("wbKeepCalling",e)},t.wbCalleeAck=function(e){return n.verifyOptions(e,"account channelId type accepted","wb::wbCalleeAck"),this.cbAndSendCmd("wbCalleeAck",e)},t.wbHangup=function(e){return n.verifyOptions(e,"channelId","wb::wbHangup"),this.cbAndSendCmd("wbHangup",e)},t.wbControl=function(e){return n.verifyOptions(e,"channelId type","wb::wbControl"),e.info=e.info||"",this.cbAndSendCmd("wbControl",e)},t.wbCreateChannel=function(e){return this.cbAndSendCmd("wbCreateChannel",e)},t.wbJoinChannel=function(e){return n.verifyOptions(e,"channelName","wb::wbJoinChannel"),n.verifyBooleanWithDefault(e,"liveEnable",!1,"","wb::wbJoinChannel"),n.verifyBooleanWithDefault(e,"webrtcEnable",!1,"","wb::wbJoinChannel"),this.cbAndSendCmd("wbJoinChannel",{channelName:e.channelName,liveOption:{liveEnable:e.liveEnable?1:0,webrtcEnable:e.webrtcEnable?1:0}})},t.wbQueryAccountUidMap=function(e,t){return this.cbAndSendCmd("wbQueryAccountUidMap",{channelName:e,uids:t})}}};e.exports=o},function(e,t,n){"use strict";var i,o=n(96),r=(i=o)&&i.__esModule?i:{default:i};n(137);var a=n(366),s=n(365),c=n(364),u=n(363),l=n(349),f=n(50),d=n(361),p=n(360),h=n(359),b=(0,r.default)({},f.constantBB,{install:function(e,t){a.install(e,t),s.install(e,t),e.parser.mixin({configMap:d,serializeMap:p,unserializeMap:h})},use:function(e){l.use(e)},getInstance:function(e){return new u(e)},destroy:function(e){e&&(e.destroy(),e=null)},checkCompatibility:function(){return c()}});e.exports=b}])});